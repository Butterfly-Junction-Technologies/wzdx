{
  "$id": "TODO PERMALINK",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "WZDx v4.0 Road Restriction Feed",
  "description": "The GeoJSON output of a WZDx road restriction data feed (v4.0)",
  "type": "object",
  "properties": {
    "feed_info": {
      "$ref": "https://raw.githubusercontent.com/usdot-jpo-ode/wzdx/field-devices/schemas/4.0/FeedInfo.json"
    },
    "type": {
      "description": "The GeoJSON type",
      "enum": [
        "FeatureCollection"
      ]
    },
    "features": {
      "description": "An array of GeoJSON Feature objects which represent WZDx restriction road events",
      "type": "array",
      "items": {
        "$ref": "#/definitions/RoadEventFeature"
      }
    },
    "bbox": {
      "$ref": "https://raw.githubusercontent.com/usdot-jpo-ode/wzdx/field-devices/schemas/4.0/BoundingBox.json"
    }
  },
  "required": [
    "road_event_feed_info",
    "type",
    "features"
  ],
  "definitions": {
    "RoadEventFeature": {
      "title": "Road Event Feature (GeoJSON Feature)",
      "description": "The container object for a specific WZDx road event (only RestrictionRoadEvent in the RoadRestrictionFeed); a GeoJSON Feature",
      "type": "object",
      "properties": {
        "id": {
          "description": "A unique identifier issued by the data feed provider to identify the WZDx road event",
          "type": "string"
        },
        "type": {
          "description": "The GeoJSON object type; must be 'Feature'",
          "enum": [
            "Feature"
          ]
        },
        "properties": {
          "$ref": "#/definitions/RestrictionRoadEvent"
        },
        "geometry": {
          "oneOf": [
            {
              "$ref": "https://geojson.org/schema/LineString.json"
            },
            {
              "$ref": "https://geojson.org/schema/MultiPoint.json"
            }
          ]
        },
        "bbox": {
          "$ref": "https://raw.githubusercontent.com/usdot-jpo-ode/wzdx/field-devices/schemas/4.0/BoundingBox.json"
        }
      },
      "required": [
        "type",
        "properties",
        "geometry",
        "id"
      ]
    },
    "RestrictionRoadEvent": {
      "title": "Restriction Road Event",
      "description": "A road event describing a section of roadway and the limitations of how that section can be used",
      "type": "object",
      "properties": {
        "core_details": {
          "$ref": "https://raw.githubusercontent.com/usdot-jpo-ode/wzdx/field-devices/schemas/4.0/RoadEventCoreDetails.json"
        },
        "restrictions": {
          "description": "A list of zero or more restrictions applying to the road event",
          "type": "array",
          "items": {
            "$ref": "#/definitions/Restriction"
          }
        },
        "lanes": {
          "description": "A list of individual lanes within a road event (roadway segment)",
          "type": "array",
          "items": {
            "$ref": "#/definitions/Lane"
          }
        }
      },
      "required": [
        "core_details"
      ],
      "anyOf": [
        {
          "required": [
            "restrictions"
          ]
        },
        {
          "required": [
            "lanes"
          ]
        }
      ]
    },
    "Lane": {
      "title": "Lane",
      "description": "An individual lane within a road event",
      "type": "object",
      "properties": {
        "order": {
          "description": "The position (index) of the lane in sequence on the roadway, where '1' represents the left-most lane",
          "type": "integer",
          "minimum": 1
        },
        "status": {
          "$ref": "#/definitions/LaneStatus"
        },
        "type": {
          "$ref": "#/definitions/LaneType"
        },
        "lane_number": {
          "description": "The number assigned to the lane to help identify its position. Flexible, but usually used for regular, driveable lanes",
          "type": "integer",
          "minimum": 1
        },
        "restrictions": {
          "description": "A list of restrictions specific to the lane",
          "type": "array",
          "items": {
            "$ref": "#/definitions/Restriction"
          }
        }
      },
      "required": [
        "status",
        "type",
        "order"
      ]
    },
    "Restriction": {
      "title": "Restriction",
      "description": "A restriction on a roadway or lane, including type and value",
      "type": "object",
      "properties": {
        "type": {
          "$ref": "#/definitions/RestrictionType"
        },
        "value": {
          "type": "number"
        },
        "unit": {
          "$ref": "#/definitions/UnitOfMeasurement"
        }
      },
      "required": [
        "type"
      ],
      "dependencies": {
        "value": [
          "unit"
        ]
      }
    },
    "RestrictionType": {
      "title": "Restriction Type Enumerated Type",
      "description": "The type of vehicle restriction on a roadway",
      "enum": [
        "no-trucks",
        "travel-peak-hours-only",
        "hov-3",
        "hov-2",
        "no-parking",
        "reduced-width",
        "reduced-height",
        "reduced-length",
        "reduced-weight",
        "axle-load-limit",
        "gross-weight-limit",
        "towing-prohibited",
        "permitted-oversize-loads-prohibited",
        "local-access-only"
      ]
    },
    "LaneStatus": {
      "title": "Lane Status Enumerated Type",
      "description": "The status of the lane for the traveling public",
      "enum": [
        "open",
        "closed",
        "shift-left",
        "shift-right",
        "merge-left",
        "merge-right",
        "alternating-one-way",
        "alternating-flow"
      ]
    },
    "LaneType": {
      "title": "Lane Type Enumerated Type",
      "description": "An indication of the type of lane or shoulder",
      "enum": [
        "lane",
        "right-turning-lane",
        "left-turning-lane",
        "right-exit-lane",
        "left-exit-lane",
        "right-entrance-lane",
        "left-entrance-lane",
        "sidewalk",
        "bike-lane",
        "alternating-flow-lane",
        "shoulder",
        "hov-lane",
        "reversible-lane",
        "center-left-turn-lane",
        "left-lane",
        "right-lane",
        "middle-lane",
        "center-lane",
        "right-shoulder",
        "left-shoulder",
        "right-merging-lane",
        "left-merging-lane",
        "right-exit-ramp",
        "right-second-exit-ramp",
        "left-exit-ramp",
        "left-second-exit-ramp",
        "right-entrance-ramp",
        "right-second-entrance-ramp",
        "left-entrance-ramp",
        "left-second-entrance-ramp"
      ]
    },
    "UnitOfMeasurement": {
      "title": "Unit of Measurement Enumerated Type",
      "description": "Unit of measurement, used when providing a unit to accompany a value",
      "enum": [
        "feet",
        "inches",
        "centimeters",
        "pounds",
        "tons",
        "kilograms"
      ]
    }
  }
}